<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Chatbot</title>
<style>
  body { font-family: 'Segoe UI', sans-serif; background: #f5f7fa; display: flex; justify-content: center; align-items: center; height: 100vh; margin:0;}
  #chat-container { width: 100%; max-width: 400px; height: 600px; background: #fff; border-radius: 15px; box-shadow:0 8px 20px rgba(0,0,0,0.15); display:flex; flex-direction:column; overflow:hidden;}
  #chat-container h2 { background:#4b7bec; color:#fff; text-align:center; padding:15px; font-size:1.5em; margin:0;}
  #chat-box { flex:1; padding:15px; overflow-y:auto; background:#eef1f6;}
  .user-message, .bot-message { max-width:80%; margin:8px 0; padding:10px 15px; border-radius:20px; line-height:1.4; word-wrap:break-word; clear:both;}
  .user-message { background:#4b7bec; color:#fff; align-self:flex-end; border-bottom-right-radius:0;}
  .bot-message { background:#e0e0e0; color:#333; align-self:flex-start; border-bottom-left-radius:0;}
  .bot-typing span { display:inline-block; width:8px; height:8px; margin:0 2px; background:#666; border-radius:50%; animation:blink 1.4s infinite both;}
  .bot-typing span:nth-child(1) { animation-delay:0s; }
  .bot-typing span:nth-child(2) { animation-delay:0.2s; }
  .bot-typing span:nth-child(3) { animation-delay:0.4s; }
  @keyframes blink { 0%,80%,100% { opacity:0; } 40% { opacity:1; } }
  .input-container { display:flex; padding:10px; border-top:1px solid #ccc; background:#fff;}
  .input-container input { flex:1; padding:12px 15px; border-radius:25px; border:1px solid #ccc; font-size:1em; outline:none;}
  .input-container button { margin-left:10px; padding:12px 20px; background:#4b7bec; color:#fff; border:none; border-radius:25px; cursor:pointer; transition:background 0.3s; }
  .input-container button:hover { background:#3867d6; }
  #chat-box::-webkit-scrollbar { width:6px; }
  #chat-box::-webkit-scrollbar-thumb { background:rgba(0,0,0,0.2); border-radius:3px; }
</style>
</head>
<body>

<div id="chat-container">
  
  <div style="display:flex; align-items:center; padding:10px; background:#4b7bec; border-top-left-radius:15px; border-top-right-radius:15px;">
    
    <img src="logo.jpg" alt="Logo" style="width:50px; height:50px; object-fit:contain; border-radius:50%;">

    <h2 style="flex:1; text-align:center; color:#fff; margin:0; font-size:1.5em;">Janani AI Chatbot</h2>
  </div>

  <div id="chat-box"></div>
  <div class="input-container">
    <input type="text" id="user-input" placeholder="Type your message..." onkeydown="if(event.key==='Enter'){sendMessage();}">
    <button onclick="sendMessage()">Send</button>
  </div>
</div>


<script>
function sendMessage() {
    const userInputEl = document.getElementById('user-input');
    const chatBox = document.getElementById('chat-box');
    const userInput = userInputEl.value.trim();
    if (!userInput) return;


    const userMessage = document.createElement('div');
    userMessage.className = 'user-message';
    userMessage.textContent = userInput;
    chatBox.appendChild(userMessage);


    userInputEl.value = '';
    chatBox.scrollTop = chatBox.scrollHeight;


    const typingMessage = document.createElement('div');
    typingMessage.className = 'bot-message bot-typing';
    typingMessage.id = 'typing';
    typingMessage.innerHTML = '<span></span><span></span><span></span>';
    chatBox.appendChild(typingMessage);
    chatBox.scrollTop = chatBox.scrollHeight;

    
    fetch("chatbot.php", {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({message:userInput})
    })
    .then(res => res.json())
    .then(data => {
      
        const typingEl = document.getElementById('typing');
        if (typingEl) typingEl.remove();


        const botMessage = document.createElement('div');
        botMessage.className = 'bot-message';
        chatBox.appendChild(botMessage);

        const responseText = data.response || data.error || "No response";

    
        let i=0;
        function typeWriter() {
            if(i<responseText.length){
                botMessage.textContent += responseText.charAt(i);
                i++;
                chatBox.scrollTop = chatBox.scrollHeight;
                setTimeout(typeWriter,25);
            }
        }
        typeWriter();
    })
    .catch(err=>{
        const typingEl = document.getElementById('typing');
        if(typingEl) typingEl.remove();
        const errorMessage = document.createElement('div');
        errorMessage.className='bot-message';
        errorMessage.textContent='Bot: Failed to fetch response.';
        chatBox.appendChild(errorMessage);
        chatBox.scrollTop = chatBox.scrollHeight;
    });
}
</script>

</body>
</html>
